<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>家人旅遊照片上傳</title>
<style>
body { font-family: "Microsoft JhengHei", sans-serif; padding: 20px; }
input, select, button { margin: 5px 0; display: block; }
</style>
</head>
<body>
<h2>家人旅遊照片上傳</h2>

<label>選擇子資料夾：
<select id="folderName">
  <option value="">根資料夾</option>
  <option value="海邊">海邊</option>
  <option value="山區">山區</option>
</select>
</label>

<label>或建立新資料夾：
<input type="text" id="newFolderName" placeholder="輸入新資料夾名稱">
</label>

<label>選擇照片（可多檔）：
<input type="file" id="files" multiple>
</label>

<button id="uploadBtn">上傳照片</button>

<div id="result"></div>

<script>
const uploadBtn = document.getElementById("uploadBtn");
const resultDiv = document.getElementById("result");

uploadBtn.addEventListener("click", async () => {
  const folderName = document.getElementById("folderName").value;
  const newFolderName = document.getElementById("newFolderName").value;
  const files = document.getElementById("files").files;

  if (!files.length) {
    alert("請選擇至少一個檔案");
    return;
  }

  const formData = new FormData();
  formData.append("folderName", folderName);
  formData.append("newFolderName", newFolderName);

  for (let i = 0; i < files.length; i++) {
    formData.append("files[]", files[i]);
  }

  resultDiv.innerText = "上傳中...";

  try {
    const response = await fetch("https://script.google.com/macros/s/AKfycbyraNY6EO7oV92k4uoc07uo_1Tur1U8ZyCEkIbem_V9enolua8Lrsw9Qeg3H7ofthCF/exec", {
      method: "POST",
      body: formData
    });

    const data = await response.json();
    if (data.success) {
      resultDiv.innerText = "上傳成功:\n" + data.uploaded.join("\n");
    } else {
      resultDiv.innerText = "上傳失敗: " + data.message;
    }
  } catch (err) {
    resultDiv.innerText = "上傳出錯: " + err.message;
  }
});
</script>

</body>
</html>
